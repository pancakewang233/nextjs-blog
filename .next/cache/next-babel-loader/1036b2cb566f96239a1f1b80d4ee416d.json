{"ast":null,"code":"import { getDatabaseConnection } from '../../../lib/getDatabaseConnection';\nimport { User } from 'src/entity/User';\n\nconst Sessions = async (req, res) => {\n  const {\n    username,\n    password\n  } = req.body;\n  const connection = await getDatabaseConnection();\n  const user = await connection.manager.findOne(User, {\n    where: {\n      username\n    }\n  });\n\n  if (user) {\n    console.log(user);\n  } else {\n    res.statusCode = 422;\n    res.end(JSON.stringify({\n      errors: {\n        username: ['用户名不存在']\n      }\n    }));\n  }\n\n  res.setHeader('Content-Type', 'application/json;charset=utf-8');\n  res.statusCode = 200;\n  res.write('');\n  res.end();\n};\n\nexport default Sessions;","map":{"version":3,"sources":["D:/Pank/code/Pack/nextjs-blog/pages/api/v1/sessions.tsx"],"names":["getDatabaseConnection","User","Sessions","req","res","username","password","body","connection","user","manager","findOne","where","console","log","statusCode","end","JSON","stringify","errors","setHeader","write"],"mappings":"AACA,SAAQA,qBAAR,QAAoC,oCAApC;AACA,SAASC,IAAT,QAAqB,iBAArB;;AAEA,MAAMC,QAAwB,GAAG,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACnD,QAAM;AAACC,IAAAA,QAAD;AAAWC,IAAAA;AAAX,MAAuBH,GAAG,CAACI,IAAjC;AACA,QAAMC,UAAU,GAAG,MAAMR,qBAAqB,EAA9C;AACA,QAAMS,IAAI,GAAG,MAAMD,UAAU,CAACE,OAAX,CAAmBC,OAAnB,CAA2BV,IAA3B,EAAiC;AAACW,IAAAA,KAAK,EAAE;AAACP,MAAAA;AAAD;AAAR,GAAjC,CAAnB;;AAEA,MAAGI,IAAH,EAAQ;AACNI,IAAAA,OAAO,CAACC,GAAR,CAAYL,IAAZ;AACD,GAFD,MAEK;AACHL,IAAAA,GAAG,CAACW,UAAJ,GAAiB,GAAjB;AACAX,IAAAA,GAAG,CAACY,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAe;AAACC,MAAAA,MAAM,EAAE;AAACd,QAAAA,QAAQ,EAAE,CAAC,QAAD;AAAX;AAAT,KAAf,CAAR;AACD;;AACDD,EAAAA,GAAG,CAACgB,SAAJ,CAAc,cAAd,EAA8B,gCAA9B;AACAhB,EAAAA,GAAG,CAACW,UAAJ,GAAiB,GAAjB;AACAX,EAAAA,GAAG,CAACiB,KAAJ,CAAU,EAAV;AACAjB,EAAAA,GAAG,CAACY,GAAJ;AACD,CAfD;;AAiBA,eAAed,QAAf","sourcesContent":["import {NextApiHandler} from 'next';\r\nimport {getDatabaseConnection} from '../../../lib/getDatabaseConnection';\r\nimport { User } from 'src/entity/User';\r\n\r\nconst Sessions: NextApiHandler = async (req, res) => {\r\n  const {username, password} = req.body;\r\n  const connection = await getDatabaseConnection();\r\n  const user = await connection.manager.findOne(User, {where: {username}});\r\n\r\n  if(user){\r\n    console.log(user);\r\n  }else{\r\n    res.statusCode = 422\r\n    res.end(JSON.stringify({errors: {username: ['用户名不存在']}}))\r\n  }\r\n  res.setHeader('Content-Type', 'application/json;charset=utf-8');\r\n  res.statusCode = 200;\r\n  res.write('');\r\n  res.end();\r\n};\r\n\r\nexport default Sessions;\r\n"]},"metadata":{},"sourceType":"module"}