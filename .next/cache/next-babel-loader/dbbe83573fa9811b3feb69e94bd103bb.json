{"ast":null,"code":"import { getDatabaseConnection } from '../../../lib/getDatabaseConnection';\nimport { User } from 'src/entity/User';\n\nconst Users = async (req, res) => {\n  const connection = await getDatabaseConnection();\n  const {\n    username,\n    password,\n    passwordConfirmation\n  } = req.body;\n  res.setHeader('Content-Type', 'application/json;charset=utf-8');\n  const user = new User();\n  user.username = username.trim();\n  user.password = password;\n  user.passwordConfirmation = passwordConfirmation;\n  await user.validate();\n\n  if (user.hasErrors()) {\n    res.statusCode = 422;\n    res.write(JSON.stringify(user.errors));\n  } else {\n    await connection.manager.save(user);\n    res.statusCode = 200;\n    res.write(JSON.stringify(user));\n  }\n\n  res.end();\n};\n\nexport default Users;","map":{"version":3,"sources":["D:/Pank/code/Pack/nextjs-blog/pages/api/v1/users.tsx"],"names":["getDatabaseConnection","User","Users","req","res","connection","username","password","passwordConfirmation","body","setHeader","user","trim","validate","hasErrors","statusCode","write","JSON","stringify","errors","manager","save","end"],"mappings":"AACA,SAAQA,qBAAR,QAAoC,oCAApC;AACA,SAAQC,IAAR,QAAmB,iBAAnB;;AAGA,MAAMC,KAAK,GAAG,OAAOC,GAAP,EAA4BC,GAA5B,KAAqD;AACjE,QAAMC,UAAU,GAAG,MAAML,qBAAqB,EAA9C;AACA,QAAM;AAACM,IAAAA,QAAD;AAAWC,IAAAA,QAAX;AAAqBC,IAAAA;AAArB,MAA6CL,GAAG,CAACM,IAAvD;AACAL,EAAAA,GAAG,CAACM,SAAJ,CAAc,cAAd,EAA8B,gCAA9B;AACA,QAAMC,IAAI,GAAG,IAAIV,IAAJ,EAAb;AACAU,EAAAA,IAAI,CAACL,QAAL,GAAgBA,QAAQ,CAACM,IAAT,EAAhB;AACAD,EAAAA,IAAI,CAACJ,QAAL,GAAgBA,QAAhB;AACAI,EAAAA,IAAI,CAACH,oBAAL,GAA4BA,oBAA5B;AAEA,QAAMG,IAAI,CAACE,QAAL,EAAN;;AACA,MAAIF,IAAI,CAACG,SAAL,EAAJ,EAAsB;AACpBV,IAAAA,GAAG,CAACW,UAAJ,GAAiB,GAAjB;AACAX,IAAAA,GAAG,CAACY,KAAJ,CAAUC,IAAI,CAACC,SAAL,CAAeP,IAAI,CAACQ,MAApB,CAAV;AACD,GAHD,MAGO;AACL,UAAMd,UAAU,CAACe,OAAX,CAAmBC,IAAnB,CAAwBV,IAAxB,CAAN;AACAP,IAAAA,GAAG,CAACW,UAAJ,GAAiB,GAAjB;AACAX,IAAAA,GAAG,CAACY,KAAJ,CAAUC,IAAI,CAACC,SAAL,CAAeP,IAAf,CAAV;AACD;;AACDP,EAAAA,GAAG,CAACkB,GAAJ;AACD,CAnBD;;AAqBA,eAAepB,KAAf","sourcesContent":["import {NextApiRequest, NextApiResponse} from 'next';\r\nimport {getDatabaseConnection} from '../../../lib/getDatabaseConnection';\r\nimport {User} from 'src/entity/User';\r\nimport md5 from 'md5';\r\n\r\nconst Users = async (req: NextApiRequest, res: NextApiResponse) => {\r\n  const connection = await getDatabaseConnection();\r\n  const {username, password, passwordConfirmation} = req.body;\r\n  res.setHeader('Content-Type', 'application/json;charset=utf-8');\r\n  const user = new User();\r\n  user.username = username.trim();\r\n  user.password = password\r\n  user.passwordConfirmation = passwordConfirmation\r\n\r\n  await user.validate()\r\n  if (user.hasErrors()) {\r\n    res.statusCode = 422;\r\n    res.write(JSON.stringify(user.errors));\r\n  } else {\r\n    await connection.manager.save(user);\r\n    res.statusCode = 200;\r\n    res.write(JSON.stringify(user));\r\n  }\r\n  res.end();\r\n};\r\n\r\nexport default Users;\r\n"]},"metadata":{},"sourceType":"module"}